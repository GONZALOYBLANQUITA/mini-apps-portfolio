<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Miniapp ¬∑ Consecuencias de un aborto seguro</title>
  <style>
    :root{
      /* Paleta inspirada en la captura (azules suaves + lilas) */
      --bg:#eef3ff;
      --bg2:#f6f8ff;

      --card:#ffffff;
      --text:#1f2a44;
      --muted:#5d6b86;

      --navPill:#e6ecff;
      --navPillBd:#d6def7;

      --active:#4c61c8;
      --active2:#6b7eea;

      --chip:#eaf3ff;
      --chipBd:#cfe2ff;

      --accent:#ff7aa2;  /* corazon */
      --accent2:#ffa7c2;

      --warnBg:#fff3dc;
      --warnBd:#ffd79a;

      --safeBg:#e9f7ef;
      --safeBd:#bfe6cd;

      --shadow: 0 16px 34px rgba(0,0,0,0.10);
      --radius: 18px;
      --radius2: 16px;
      --focus: 0 0 0 4px rgba(107,126,234,0.18);

      --fontScale: 1; /* se ajusta con "Texto m√°s grande" */
    }

    *{ box-sizing:border-box; }
    body{
      margin:0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
      background: radial-gradient(circle at top left, #f8fbff 0%, var(--bg) 45%, #e9f1ff 100%);
      color: var(--text);
      font-size: calc(16px * var(--fontScale));
    }

    .wrap{
      max-width: 1100px;
      margin: 0 auto;
      padding: 22px 14px 30px;
    }

    .header{
      display:flex;
      align-items:flex-start;
      gap:14px;
      flex-wrap:wrap;
    }
    .heart{
      width:44px;height:44px;
      border-radius: 16px;
      display:grid;place-items:center;
      color:#fff;
      background: linear-gradient(135deg, var(--accent), var(--accent2));
      box-shadow: 0 14px 24px rgba(255,122,162,0.22);
      font-size: 22px;
      user-select:none;
    }
    h1{
      margin:0;
      font-size: 30px;
      font-weight: 950;
      letter-spacing: -0.3px;
      color:#22315a;
    }
    .sub{
      margin: 6px 0 0;
      color: var(--muted);
      line-height: 1.45;
      max-width: 860px;
    }

    .topRow{
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:10px;
      flex-wrap:wrap;
      margin-top: 12px;
    }

    .pillInfo{
      display:inline-flex;
      align-items:center;
      gap:10px;
      padding: 10px 14px;
      border-radius: 999px;
      background: var(--navPill);
      border: 1px solid var(--navPillBd);
      font-weight: 900;
      color:#2b3a67;
      user-select:none;
    }

    .tabs{
      display:flex;
      flex-wrap:wrap;
      gap:10px;
      margin-top: 14px;
    }
    .tab{
      border: 1px solid var(--navPillBd);
      background: var(--navPill);
      border-radius: 999px;
      padding: 10px 14px;
      font-weight: 950;
      cursor:pointer;
      display:inline-flex;
      align-items:center;
      gap:10px;
      color:#2b3a67;
      user-select:none;
      transition: transform .06s ease, filter .12s ease, background .12s ease;
    }
    .tab:hover{ filter: brightness(0.99); }
    .tab:active{ transform: scale(0.985); }
    .tab.active{
      background: linear-gradient(135deg, var(--active), var(--active2));
      color:#fff;
      border-color: rgba(255,255,255,0.25);
      box-shadow: 0 14px 26px rgba(76,97,200,0.22);
    }

    .rightBtn{
      margin-left:auto;
      border-radius: 999px;
      padding: 10px 14px;
      border: 1px solid rgba(76,97,200,0.35);
      background:#fff;
      font-weight: 950;
      cursor:pointer;
      display:inline-flex;
      align-items:center;
      gap:10px;
      color:#1f2a44;
      user-select:none;
    }
    .rightBtn:focus{ outline:none; box-shadow: var(--focus); }

    .panel{
      margin-top: 14px;
      background: var(--card);
      border-radius: 22px;
      box-shadow: var(--shadow);
      border: 1px solid rgba(0,0,0,0.06);
      padding: 18px;
    }

    .panelTop{
      display:flex;
      align-items:flex-start;
      justify-content:space-between;
      gap:12px;
      flex-wrap:wrap;
      margin-bottom: 10px;
    }

    .titleRow{
      display:flex;
      align-items:center;
      gap:10px;
      flex-wrap:wrap;
    }

    .h2{
      margin:0;
      font-size: 22px;
      font-weight: 950;
      letter-spacing:-0.2px;
    }

    .chip{
      border-radius: 999px;
      padding: 7px 12px;
      font-weight: 950;
      font-size: 13px;
      background: var(--chip);
      border: 1px solid var(--chipBd);
      color:#2156b7;
      white-space:nowrap;
      user-select:none;
    }

    .p{
      margin: 10px 0 0;
      color:#27324a;
      line-height: 1.6;
    }

    .box{
      margin-top: 14px;
      border-radius: var(--radius);
      padding: 14px;
      border: 1px solid rgba(0,0,0,0.08);
      background: #f7f9ff;
    }

    .box h3{
      margin:0 0 8px 0;
      font-size: 17px;
      font-weight: 950;
      color:#23305a;
      display:flex;
      align-items:center;
      gap:10px;
    }

    .box ul{
      margin:0;
      padding-left: 18px;
      line-height: 1.55;
    }
    .box li{ margin: 7px 0; }

    .msgKey{
      margin-top: 14px;
      border-radius: var(--radius);
      padding: 14px;
      background: var(--warnBg);
      border: 1px solid var(--warnBd);
      color:#6b3b00;
      line-height: 1.5;
    }
    .msgKey b{ font-weight: 950; }

    .safe{
      margin-top: 14px;
      border-radius: var(--radius);
      padding: 14px;
      background: var(--safeBg);
      border: 1px solid var(--safeBd);
      color:#0f5132;
      line-height: 1.5;
    }
    .safe b{ font-weight: 950; }

    .form{
      margin-top: 12px;
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 12px;
    }
    @media (max-width: 820px){
      .form{ grid-template-columns: 1fr; }
    }

    label{
      font-weight: 950;
      color:#23305a;
      display:flex;
      align-items:center;
      gap:10px;
      font-size: 14px;
    }
    input, textarea, select{
      width:100%;
      margin-top: 6px;
      border-radius: 14px;
      border: 1px solid rgba(0,0,0,0.12);
      padding: 12px 12px;
      font-size: 15px;
      outline:none;
      background:#fff;
      color:#1f2a44;
    }
    textarea{ min-height: 92px; resize: vertical; }
    input:focus, textarea:focus, select:focus{ box-shadow: var(--focus); border-color: rgba(107,126,234,0.6); }

    .btnRow{
      display:flex;
      gap:10px;
      flex-wrap:wrap;
      margin-top: 12px;
    }
    .btn{
      border:none;
      border-radius: 999px;
      padding: 11px 14px;
      font-weight: 950;
      cursor:pointer;
      font-size: 15px;
      display:inline-flex;
      align-items:center;
      gap:10px;
      user-select:none;
      transition: transform .06s ease, filter .15s ease, opacity .15s ease;
    }
    .btn:active{ transform: scale(0.985); }
    .btnPrimary{
      background: linear-gradient(135deg, var(--active), var(--active2));
      color:#fff;
      box-shadow: 0 12px 22px rgba(76,97,200,0.18);
    }
    .btnSoft{
      background:#fff;
      border: 1px solid rgba(0,0,0,0.12);
      color:#1f2a44;
    }
    .btnDanger{
      background: linear-gradient(135deg, #ff5a6d, #ff9aa5);
      color:#fff;
    }

    .split{
      display:grid;
      grid-template-columns: 1fr 1fr;
      gap: 14px;
      margin-top: 14px;
    }
    @media (max-width: 900px){
      .split{ grid-template-columns: 1fr; }
    }

    .miniCard{
      background:#fff;
      border: 1px solid rgba(0,0,0,0.10);
      border-radius: var(--radius);
      padding: 14px;
    }
    .miniCard h4{
      margin:0 0 8px 0;
      font-size: 16px;
      font-weight: 950;
      display:flex;
      align-items:center;
      gap:10px;
      color:#22315a;
    }
    .miniCard p{
      margin:0;
      color:#2a3550;
      line-height:1.55;
    }

    .footer{
      margin-top: 14px;
      text-align:center;
      color:#46506a;
      opacity:0.85;
      font-size: 13.5px;
      line-height:1.45;
    }

    .copyBox{
      margin-top: 12px;
      border-radius: var(--radius);
      background:#f8fbff;
      border:1px solid #dbe7ff;
      padding: 12px;
      display:none;
    }
    .copyBox pre{
      margin:0;
      white-space: pre-wrap;
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      font-size: 13.5px;
      line-height:1.4;
      color:#1f2a44;
    }
  </style>
</head>

<body>
  <div class="wrap">
    <div class="header">
      <div class="heart">üíó</div>
      <div>
        <h1>Miniapp ¬∑ Consecuencias de un aborto seguro</h1>
        <div class="sub">
          Espacio psicoeducativo y de reflexi√≥n. No es un juicio, ni un serm√≥n.
          Es informaci√≥n clara para comprender lo que puede ocurrir y para cuidar tu bienestar.
        </div>

        <div class="topRow">
          <div class="pillInfo">üßò‚Äç‚ôÄÔ∏è Informaci√≥n + autocuidado emocional</div>
          <button class="rightBtn" id="btnText">üîé Texto m√°s grande</button>
        </div>

        <div class="tabs" id="tabs"></div>
      </div>
    </div>

    <div class="panel">
      <div class="panelTop">
        <div class="titleRow">
          <div class="h2" id="panelTitle">üè† Bienvenida</div>
          <span class="chip" id="panelChip">Espacio seguro</span>
        </div>
      </div>

      <div id="panelBody"></div>

      <div class="footer">
        Desarrollado por <b>Lic. Gonzalo Buend√≠a ‚Äì Psic√≥logo</b> y <b>Blanquita ‚Äì Co-terapeuta</b> üêæ
      </div>
    </div>
  </div>

  <script>
    // =========================
    //   DATA
    // =========================
    const KEY = "miniapp_aborto_seguro_v1";

    const SECTIONS = [
      { id:"inicio",   label:"Inicio",              icon:"üè†", chip:"Espacio seguro" },
      { id:"fisicas",  label:"Consecuencias f√≠sicas",icon:"ü©∫", chip:"Cuerpo" },
      { id:"emociones",label:"Emociones comunes",    icon:"üíó", chip:"Emoci√≥n" },
      { id:"moral",    label:"Conflicto moral interno", icon:"üß†", chip:"Significado" },
      { id:"familia",  label:"Pareja y familia",     icon:"üë®‚Äçüë©‚Äçüëß", chip:"V√≠nculos" },
      { id:"largo",    label:"A largo plazo",        icon:"üå±", chip:"Tiempo" },
      { id:"ayuda",    label:"Cu√°ndo pedir ayuda",   icon:"üÜò", chip:"Apoyo" }
    ];

    const CONTENT = {
      inicio: {
        title:"üè† Bienvenida",
        chip:"Espacio seguro",
        body: () => `
          <p class="p">
            Esta miniapp te ofrece una mirada calmada y respetuosa sobre las posibles
            <b>consecuencias f√≠sicas, emocionales y relacionales</b> de un aborto seguro.
          </p>
          <p class="p">
            No est√° hecha para juzgarte, sino para ayudarte a <b>entender lo que sientes</b>
            y lo que puede estar ocurriendo por dentro y a tu alrededor.
          </p>

          <div class="box">
            <h3>üìå Algunas ideas importantes antes de empezar</h3>
            <ul>
              <li>Las consecuencias no son iguales para todas las mujeres.</li>
              <li>Muchas contin√∫an su vida sin problemas emocionales graves.</li>
              <li>Otras necesitan tiempo, palabras y apoyo para procesar lo vivido.</li>
            </ul>
          </div>

          <div class="msgKey">
            <b>Mensaje clave:</b> Sentir alivio, tristeza, culpa, duda, o mezcla de todo
            <b>no te hace mala persona</b>. Son reacciones humanas frente a una experiencia compleja.
          </div>

          <div class="safe">
            <b>Peque√±o check-in contigo</b><br/>
            Si te escuchas por dentro ahora mismo, ¬øqu√© palabra describe mejor c√≥mo te sientes?
            (Ej.: confundida, cansada, tranquila, aliviada, triste, en pausa‚Ä¶)
            <div class="form" style="margin-top:12px;">
              <div>
                <label>ü´∂ Palabra / emoci√≥n</label>
                <input id="moodNow" type="text" placeholder="Escribe aqu√≠..." />
              </div>
              <div>
                <label>üìù Nota breve (opcional)</label>
                <input id="moodNote" type="text" placeholder="Ej.: hoy me siento..." />
              </div>
            </div>
            <div class="btnRow">
              <button class="btn btnPrimary" id="btnSaveMood">üíæ Guardar</button>
              <button class="btn btnSoft" id="btnCopyMood">üìã Copiar</button>
            </div>
            <div class="copyBox" id="moodBox"><pre id="moodText"></pre></div>
          </div>
        `
      },

      fisicas: {
        title:"ü©∫ Consecuencias f√≠sicas",
        chip:"Cuerpo",
        body: () => `
          <p class="p">
            Un aborto seguro suele cursar con s√≠ntomas f√≠sicos <b>transitorios</b>.
            La experiencia var√≠a seg√∫n el m√©todo, el momento del proceso y el cuerpo de cada persona.
          </p>

          <div class="split">
            <div class="miniCard">
              <h4>üßæ Lo m√°s frecuente (esperable)</h4>
              <p>
                C√≥licos, sangrado tipo menstruaci√≥n (a veces m√°s), cansancio, cambios leves de sue√±o,
                sensibilidad corporal. En general, disminuye progresivamente con los d√≠as.
              </p>
            </div>
            <div class="miniCard">
              <h4>üß≠ Cuidados b√°sicos</h4>
              <p>
                Descanso, hidrataci√≥n, alimentaci√≥n simple, acompa√±amiento, y seguir indicaciones cl√≠nicas si existen.
                Evitar exigirse ‚Äúcomo si nada‚Äù.
              </p>
            </div>
          </div>

          <div class="msgKey">
            <b>Nota:</b> Si tienes s√≠ntomas intensos o persistentes, lo m√°s seguro es consultar con un profesional de salud.
          </div>
        `
      },

      emociones: {
        title:"üíó Emociones comunes",
        chip:"Emoci√≥n",
        body: () => `
          <p class="p">
            Es habitual que aparezcan emociones mixtas. A veces se sienten en olas:
            d√≠as ‚Äúbien‚Äù y d√≠as sensibles. Eso no significa que est√©s retrocediendo.
          </p>

          <div class="box">
            <h3>ü´ß Emociones que pueden aparecer</h3>
            <ul>
              <li><b>Alivio</b> (por cierre de una situaci√≥n dif√≠cil).</li>
              <li><b>Tristeza</b> o sensaci√≥n de p√©rdida.</li>
              <li><b>Culpa</b> (por creencias, presi√≥n externa o autoexigencia).</li>
              <li><b>Ansiedad</b> (por dudas, miedo al juicio, o incertidumbre).</li>
              <li><b>Entumecimiento</b> o desconexi√≥n (mecanismo de protecci√≥n).</li>
            </ul>
          </div>

          <div class="safe">
            <b>Mini herramienta (30 segundos):</b><br/>
            Nombra: 1 emoci√≥n + 1 sensaci√≥n corporal + 1 necesidad (ej.: ‚Äútristeza / presi√≥n en pecho / necesito descanso‚Äù).
          </div>
        `
      },

      moral: {
        title:"üß† Conflicto moral interno",
        chip:"Significado",
        body: () => `
          <p class="p">
            A veces el dolor no viene del hecho en s√≠, sino del <b>significado</b>:
            valores, creencias, mensajes familiares, religi√≥n, cultura, o el temor a ‚Äúser juzgada‚Äù.
          </p>

          <div class="split">
            <div class="miniCard">
              <h4>üß© Dos cosas pueden ser verdad</h4>
              <p>
                Puedes haber tomado la mejor decisi√≥n posible en tu contexto <b>y</b> aun as√≠ sentir ambivalencia.
                La mente intenta ‚Äúordenar‚Äù lo vivido.
              </p>
            </div>
            <div class="miniCard">
              <h4>üß≠ Pregunta gu√≠a</h4>
              <p>
                ¬øQu√© parte de m√≠ est√° sufriendo: mi cuerpo, mi coraz√≥n, mis valores, o el miedo al juicio?
                Responder esto reduce confusi√≥n.
              </p>
            </div>
          </div>

          <div class="msgKey">
            <b>Mensaje clave:</b> El conflicto moral no se resuelve con castigo, sino con comprensi√≥n, di√°logo interno y apoyo.
          </div>
        `
      },

      familia: {
        title:"üë®‚Äçüë©‚Äçüëß Pareja y familia",
        chip:"V√≠nculos",
        body: () => `
          <p class="p">
            Las relaciones pueden cambiar: algunas se fortalecen, otras se tensan.
            Puede haber silencio, incomodidad o discusiones si no hay un lenguaje com√∫n para hablar del tema.
          </p>

          <div class="box">
            <h3>üó£Ô∏è Comunicaci√≥n protectora</h3>
            <ul>
              <li>Habla desde ‚Äúyo siento / yo necesito‚Äù, no desde culpas.</li>
              <li>Pide lo concreto: compa√±√≠a, respeto, espacio, o silencio sin juicio.</li>
              <li>Si la otra persona no puede sostener, busca un apoyo alterno (amiga, profesional).</li>
            </ul>
          </div>

          <div class="safe">
            <b>Frase puente:</b> ‚ÄúAhora necesito contenci√≥n, no opiniones. Despu√©s conversamos con calma.‚Äù
          </div>
        `
      },

      largo: {
        title:"üå± A largo plazo",
        chip:"Tiempo",
        body: () => `
          <p class="p">
            Con el tiempo, muchas personas integran la experiencia y recuperan estabilidad.
            Si quedan emociones pendientes, suelen responder bien a acompa√±amiento psicol√≥gico breve y focal.
          </p>

          <div class="split">
            <div class="miniCard">
              <h4>üßò Autocuidado que s√≠ ayuda</h4>
              <p>
                Rutina suave, dormir, comer, caminar, escribir, hablar con alguien seguro, y reducir exposici√≥n a juicio.
              </p>
            </div>
            <div class="miniCard">
              <h4>üßæ Se√±ales de integraci√≥n</h4>
              <p>
                Menos rumiaci√≥n, m√°s claridad, disminuci√≥n de culpa, capacidad de recordar sin colapsar,
                y re-conectar con proyectos.
              </p>
            </div>
          </div>

          <div class="box">
            <h3>ü™∑ Mini plan de autocuidado (hoy)</h3>
            <ul>
              <li>1 cosa amable para tu cuerpo (agua / descanso / comida simple).</li>
              <li>1 cosa amable para tu mente (pausa de redes / m√∫sica / respiraci√≥n).</li>
              <li>1 contacto seguro (mensaje breve o cita).</li>
            </ul>
          </div>
        `
      },

      ayuda: {
        title:"üÜò Cu√°ndo pedir ayuda",
        chip:"Apoyo",
        body: () => `
          <p class="p">
            Pedir ayuda no significa que est√©s ‚Äúmal‚Äù. Significa que quieres cuidarte.
            Aqu√≠ tienes un sem√°foro simple para orientarte:
          </p>

          <div class="split">
            <div class="miniCard">
              <h4>üü¢ Amarillo (acompa√±amiento recomendado)</h4>
              <p>
                Tristeza frecuente, culpa que no baja, conflicto interno intenso, dificultades para dormir,
                discusiones constantes o aislamiento.
              </p>
            </div>
            <div class="miniCard">
              <h4>üü† Naranja (consulta pronta)</h4>
              <p>
                Crisis de ansiedad repetidas, pensamientos intrusivos persistentes, sensaci√≥n de desborde,
                consumo de alcohol/sustancias para calmar.
              </p>
            </div>
          </div>

          <div class="msgKey">
            <b>Si sientes que no puedes con esto sola</b>, busca apoyo profesional o de una persona de confianza.
            Mereces contenci√≥n y claridad.
          </div>

          <div class="safe">
            <b>Registro breve (opcional)</b><br/>
            Completa esto para tener una idea clara de tu estado y lo que necesitas.
            <div class="form" style="margin-top:12px;">
              <div>
                <label>üìÖ Fecha</label>
                <input id="logDate" type="text" placeholder="Ej.: 12/01/2026" />
              </div>
              <div>
                <label>üìå Intensidad (0‚Äì10)</label>
                <input id="logInt" type="number" min="0" max="10" placeholder="Ej.: 6" />
              </div>
              <div style="grid-column:1/-1;">
                <label>üìù ¬øQu√© necesitas hoy?</label>
                <textarea id="logNeed" placeholder="Ej.: hablar con alguien, dormir, ordenar mi cabeza..."></textarea>
              </div>
            </div>

            <div class="btnRow">
              <button class="btn btnPrimary" id="btnSaveLog">üíæ Guardar registro</button>
              <button class="btn btnSoft" id="btnCopyAll">üìã Copiar resumen</button>
              <button class="btn btnDanger" id="btnClearAll">üßº Borrar todo</button>
            </div>

            <div class="copyBox" id="allBox"><pre id="allText"></pre></div>
          </div>
        `
      }
    };

    // =========================
    //   UI
    // =========================
    const tabsEl = document.getElementById("tabs");
    const panelTitleEl = document.getElementById("panelTitle");
    const panelChipEl = document.getElementById("panelChip");
    const panelBodyEl = document.getElementById("panelBody");
    const btnText = document.getElementById("btnText");

    let current = "inicio";
    let bigText = false;

    buildTabs();
    render();

    btnText.addEventListener("click", ()=>{
      bigText = !bigText;
      document.documentElement.style.setProperty("--fontScale", bigText ? "1.12" : "1");
      btnText.textContent = bigText ? "üîé Texto normal" : "üîé Texto m√°s grande";
    });

    function buildTabs(){
      tabsEl.innerHTML = "";
      SECTIONS.forEach(s=>{
        const b = document.createElement("button");
        b.type = "button";
        b.className = "tab";
        b.dataset.id = s.id;
        b.innerHTML = `<span>${s.icon}</span><span>${escapeHtml(s.label)}</span>`;
        b.addEventListener("click", ()=> setTab(s.id));
        tabsEl.appendChild(b);
      });
    }

    function setTab(id){
      current = id;
      document.querySelectorAll(".tab").forEach(t=>{
        t.classList.toggle("active", t.dataset.id === id);
      });
      render();
      panelTitleEl.scrollIntoView({behavior:"smooth", block:"start"});
    }

    function render(){
      // activar estado de tabs
      document.querySelectorAll(".tab").forEach(t=>{
        t.classList.toggle("active", t.dataset.id === current);
      });

      const c = CONTENT[current];
      panelTitleEl.textContent = c.title;
      panelChipEl.textContent = (SECTIONS.find(x=>x.id===current)?.chip) || c.chip || "Espacio seguro";
      panelBodyEl.innerHTML = c.body();

      // binds din√°micos por secci√≥n
      if(current === "inicio") bindInicio();
      if(current === "ayuda") bindAyuda();
      hydrateSaved();
    }

    // =========================
    //   STORAGE
    // =========================
    function loadData(){
      const raw = localStorage.getItem(KEY);
      if(!raw) return {};
      try{ return JSON.parse(raw) || {}; }catch(e){ return {}; }
    }
    function saveData(d){
      localStorage.setItem(KEY, JSON.stringify(d));
    }

    function hydrateSaved(){
      const d = loadData();

      // inicio
      const moodNow = document.getElementById("moodNow");
      const moodNote = document.getElementById("moodNote");
      if(moodNow && d.moodNow) moodNow.value = d.moodNow;
      if(moodNote && d.moodNote) moodNote.value = d.moodNote;

      // ayuda
      const logDate = document.getElementById("logDate");
      const logInt  = document.getElementById("logInt");
      const logNeed = document.getElementById("logNeed");
      if(logDate && d.logDate) logDate.value = d.logDate;
      if(logInt && (d.logInt!==undefined && d.logInt!==null)) logInt.value = d.logInt;
      if(logNeed && d.logNeed) logNeed.value = d.logNeed;
    }

    // =========================
    //   BINDS
    // =========================
    function bindInicio(){
      const btnSaveMood = document.getElementById("btnSaveMood");
      const btnCopyMood = document.getElementById("btnCopyMood");

      btnSaveMood.addEventListener("click", ()=>{
        const d = loadData();
        d.moodNow = (document.getElementById("moodNow").value || "").trim();
        d.moodNote = (document.getElementById("moodNote").value || "").trim();
        d.updatedISO = new Date().toISOString();
        saveData(d);
        showMoodBox(d);
        alert("Guardado ‚úÖ");
      });

      btnCopyMood.addEventListener("click", async ()=>{
        const mood = (document.getElementById("moodNow").value || "").trim();
        const note = (document.getElementById("moodNote").value || "").trim();
        const text =
`Check-in (hoy)
Emoci√≥n/palabra: ${mood || "‚Äî"}
Nota: ${note || "‚Äî"}`;
        await safeCopy(text, "moodBox", "moodText");
      });
    }

    function bindAyuda(){
      const btnSaveLog = document.getElementById("btnSaveLog");
      const btnCopyAll = document.getElementById("btnCopyAll");
      const btnClearAll= document.getElementById("btnClearAll");

      btnSaveLog.addEventListener("click", ()=>{
        const d = loadData();
        d.logDate = (document.getElementById("logDate").value || "").trim();
        d.logInt  = (document.getElementById("logInt").value || "").trim();
        d.logNeed = (document.getElementById("logNeed").value || "").trim();
        d.updatedISO = new Date().toISOString();
        saveData(d);
        showAllBox(d);
        alert("Registro guardado ‚úÖ");
      });

      btnCopyAll.addEventListener("click", async ()=>{
        const d = loadData();
        const mood = d.moodNow || "";
        const note = d.moodNote || "";
        const text =
`Miniapp ¬∑ Consecuencias de un aborto seguro ‚Äî Resumen
Check-in:
- Emoci√≥n/palabra: ${mood || "‚Äî"}
- Nota: ${note || "‚Äî"}

Registro de apoyo:
- Fecha: ${d.logDate || "‚Äî"}
- Intensidad (0‚Äì10): ${d.logInt || "‚Äî"}
- Necesidad hoy: ${d.logNeed || "‚Äî"}`;

        await safeCopy(text, "allBox", "allText");
      });

      btnClearAll.addEventListener("click", ()=>{
        const ok = confirm("¬øBorrar todo lo guardado en esta miniapp? (no se puede deshacer)");
        if(!ok) return;
        localStorage.removeItem(KEY);
        render(); // recarga UI
      });
    }

    // =========================
    //   UI HELPERS
    // =========================
    function showMoodBox(d){
      const box = document.getElementById("moodBox");
      const pre = document.getElementById("moodText");
      if(!box || !pre) return;
      pre.textContent =
`Check-in (hoy)
Emoci√≥n/palabra: ${d.moodNow || "‚Äî"}
Nota: ${d.moodNote || "‚Äî"}`;
      box.style.display = "block";
    }

    function showAllBox(d){
      const box = document.getElementById("allBox");
      const pre = document.getElementById("allText");
      if(!box || !pre) return;
      pre.textContent =
`Resumen
Check-in:
- Emoci√≥n/palabra: ${d.moodNow || "‚Äî"}
- Nota: ${d.moodNote || "‚Äî"}

Registro de apoyo:
- Fecha: ${d.logDate || "‚Äî"}
- Intensidad (0‚Äì10): ${d.logInt || "‚Äî"}
- Necesidad hoy: ${d.logNeed || "‚Äî"}`;
      box.style.display = "block";
    }

    async function safeCopy(text, boxId, preId){
      try{
        await navigator.clipboard.writeText(text);
        alert("Copiado ‚úÖ");
      }catch(e){
        // Fallback: mostrar caja con texto para copiar manual
        const box = document.getElementById(boxId);
        const pre = document.getElementById(preId);
        if(box && pre){
          pre.textContent = text;
          box.style.display = "block";
        }
        alert("No pude copiar autom√°ticamente. Copia manualmente del recuadro que apareci√≥.");
      }
    }

    function escapeHtml(str){
      return String(str || "")
        .replaceAll("&","&amp;")
        .replaceAll("<","&lt;")
        .replaceAll(">","&gt;")
        .replaceAll('"',"&quot;")
        .replaceAll("'","&#039;");
    }

    // init active tab
    setTab("inicio");
  </script>
</body>
</html>
